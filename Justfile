#Install just: https://github.com/casey/just#user-content-pre-built-binaries
#Infos: https://peterborocz.com/nano/just_vs_makefile/

# Loading .env file
set dotenv-load := true

default:
    @just --list

up tag='':
    #!/usr/bin/env sh
    docker compose -f "docker-compose.${GLOBAL_ENV}.yml" up --build {{tag}};

down tag='':
    #!/usr/bin/env sh
    docker compose -f "docker-compose.${GLOBAL_ENV}.yml" down;

ssh container:
	docker exec -it pentest_rustbuster_{{container}} sh

logs container:
    docker logs -f --since=1s pims_api_{{container}}

docker-stop-all:
    docker stop $(docker ps -a -q)

volume action tag='':
	docker volume {{action}} {{tag}}

init-submodules:
    git submodule add --force --name 'jb-devops_docker' --branch 'release' 'git@github.com:l3ackslash0/jb-devops_docker' docker

update-submodules:
    git submodule update --remote --force

ci:
    cargo install --path .

cb:
    cargo build

